<!DOCTYPE html>
<html>
<head>
    <% include ../partials/meta %>
    <title><%= title %></title>
    <% include ../partials/css %>
</head>
<body>

<% include ../partials/header %>

<div class="am-cf admin-main">

    <!-- sidebar start -->
    <% include ../partials/sidebar %>
    <!-- sidebar end -->

    <!-- content start -->
    <div class="admin-content admin-article-page">

        <div class="am-cf am-padding">
            <div class="am-fl am-cf"><strong><a href="/admin/article">文章列表</a></strong> / 添加文章</div>
        </div>

        <div class="am-g">
            <div class="am-u-sm-12">

                <form id="form-add-product" class="am-form" method="post" >

                    <!-- name start -->
                    <div class="am-form-group">
                        <label for="name">文章名称: <i>*</i></label>
                        <input id="name" name="name" type="text" value="" required />
                    </div>
                    <!-- name end -->

                    <hr/>

                    <!--  course template start -->
                    <div class="am-form-group">
                        <label for="article-category" >文章分类 <i>*</i></label>
                        <select required name="articleCategoryId" id="article-category">
                            <option value="">选择分类</option>
                            <% for (var i = 0; i < articleCategory.length; i++) { %>
                            <option value="<%= articleCategory[i].get('articleCategoryId')%>"><%= articleCategory[i].get('name')%></option>
                            <% } %>
                        </select>
                    </div>
                    <!--  course template end -->

                    <hr/>

                    <!-- images start -->
                    <div class="am-form-group">
                        <label for="image">文章主图图片(大小750px*750px): <i>*</i></label>
                        <input required id="image" name="image" type="text" placeholder="输入文章图片"/>
                        <div class="main-image-view"></div>
                        <hr>
                        <div class="upload-content">
                            <iframe class="upload" src="/admin/article/upload?callback=uploadMainImageSuccess" frameborder="0"></iframe>
                        </div>
                    </div>
                    <!-- images end -->

                    <hr/>

                    <!-- content start -->
                    <div class="am-form-group">
                        <label for="content">文章详情 <small>(md5)</small>:</label>
                        <textarea id="content" name="content" rows="10"></textarea>
                    </div>

                    <!-- images start -->
                    <div class="am-form-group">
                        <label for="detail-image">添加详情图片(建议图片宽度：800px，可多选图片)：</label>
                        <div class="upload-content">
                            <iframe class="upload" src="/admin/article/upload?callback=uploadDetailImageSuccess" frameborder="0"></iframe>
                        </div>
                        <ul class="image-list"></ul>
                        <input id="detail-images" name="detail-images" type="text">
                    </div>
                    <!-- images end -->
                    <!-- content end -->

                    <hr/>

                    <!-- content start -->
                    <div class="am-form-group">
                        <label for="content">网店链接:</label>
                        <input type="text" id="taoBaoLink" name="taoBaoLink">
                    </div>
                    <!-- content end -->

                    <!-- video start -->
                    <div class="am-form-group">
                        <label for="video-link">文章视频：</label>
                        <input id="video-link" name="video-link" type="text" placeholder="输入文章视频"/>
                        <div class="video-view"></div>
                        <hr/>
                        <div class="upload-content">
                            <iframe class="upload" src="/admin/article/upload?callback=uploadVideoFileSuccess" frameborder="0"></iframe>
                        </div>
                    </div>
                    <!-- video end -->

                    <input id="detail-images" name="detail-images" type="hidden">
                    <hr>

                    <div class="am-form-group">
                        <button id="submit" type="submit" class="am-btn am-btn-primary">保存</button>
                        <button type="button" class="am-btn am-btn-primary" onclick="history.back(-1);">返回</button>
                    </div>

                </form>

            </div>
        </div>

    </div>
    <!-- content end -->

</div>


<% include ../partials/footer %>
<% include ../partials/js %>

<script type="text/javascript">
    var article;
    $(function () {
        require('upload');
        article = require('article');
        article.addFun();
    });

    //iframe upload detail images callback
    function uploadDetailImageSuccess(data) {
        article.uploadDetailImageSuccess(data);
    }

    //iframe upload callback
    function uploadMainImageSuccess(data) {
        $('#image').val(data[0].url).trigger('change');
    }
    //iframe upload callback
    function uploadVideoFileSuccess(data) {
        $('#video-link').val(data[0].url).trigger('change');;
    }
</script>
</body>
</html>