<!DOCTYPE html>
<html>
<head>
    <% include ../partials/meta %>
    <title><%= title %></title>
    <% include ../partials/css %>
</head>
<body>

<% include ../partials/header %>

<div class="am-cf admin-main">

    <!-- sidebar start -->
    <% include ../partials/sidebar %>
    <!-- sidebar end -->

    <!-- content start -->
    <div class="admin-content admin-article-page">

        <div class="am-cf am-padding">
            <div class="am-fl am-cf"><strong><a href="/admin/article">文章列表</a></strong> / 编辑文章</div>
        </div>

        <div class="am-g">
            <div class="am-u-sm-12">

                <form id="form-add-product" class="am-form" method="post" >

                    <!-- name start -->
                    <div class="am-form-group">
                        <label for="name">文章名称: <i>*</i></label>
                        <input id="name" name="name" type="text" value="<%= article.get('name') %>" required />
                    </div>
                    <!-- name end -->

                    <hr/>

                    <!--  course template start -->
                    <div class="am-form-group">
                        <label for="article-category" >文章分类<i>*</i></label>
                        <select required name="articleCategoryId" id="article-category">
                            <option value="">选择分类</option>
                            <% for (var i = 0; i < articleCategory.length; i++) { %>
                            <option <% if (articleCategory[i].get('articleCategoryId') == article.get('articleCategoryId')) { %>selected<% } %> value="<%= articleCategory[i].get('articleCategoryId')%>"><%= articleCategory[i].get('name')%></option>
                            <% } %>
                        </select>
                    </div>
                    <!--  course template end -->

                    <hr/>

                    <!-- images start -->
                    <div class="am-form-group">
                        <label for="image">文章主图图片(大小750px*750px): <i>*</i></label>
                        <input required id="image" name="image" type="text" placeholder="输入文章图片" value="<%= article.get('image')%>"/>
                        <div class="main-image-view">
                            <% if(article.get('image')) { %>
                             <a href="<%= article.get('image') %>" target="_blank">
                                 <img width="100" src="<%= article.get('image') %>?imageMogr2/thumbnail/100">
                             </a>
                            <%}%>
                        </div>
                        <hr/>
                        <div class="upload-content">
                            <iframe class="upload" src="/admin/article/upload?callback=uploadMainImageSuccess" frameborder="0"></iframe>
                        </div>
                    </div>
                    <!-- images end -->

                    <hr/>

                    <!-- content start -->
                    <div class="am-form-group">
                        <label for="content">文章详情<small>(md5)</small>:</label>
                        <textarea id="content" name="content" rows="10"><%= article.get('content') %></textarea>
                    </div>

                    <!-- images start -->
                    <div class="am-form-group">
                        <label for="detail-image">添加详情图片(建议图片宽度：800px，可多选图片)：</label>
                        <div class="upload-content">
                            <iframe class="upload" src="/admin/article/upload?callback=uploadDetailImageSuccess" frameborder="0"></iframe>
                        </div>
                        <ul class="image-list">
                            <%  var detailImageArray = article.get('detailImages').split(',');

                            if(detailImageArray.length) {
                            for (var i =0;i< detailImageArray.length; i++) { %>
                            <li class="am-cf">
                                <div class="am-fl"><input type="checkbox" /></div>
                                <div class="am-fr">
                                    <p><a class="img-link" href="<%= detailImageArray[i]%>" target="_blank"><img src="<%= detailImageArray[i] %>?imageMogr2/thumbnail/100"/></a></p><p><a class="move" href="javascript:;">前移</a> <span class="copy"><a class="copy-url" href="javascript:;">复制</a></span> <a class="remove" href="javascript:;">删除</a></p></div></li>
                            <% } %>
                            <%}%>

                        </ul>
                        <input id="detail-images" name="detail-images" type="text" value="<%= article.get('detailImages') %>">
                    </div>
                    <!-- images end -->

                    <!-- content end -->

                    <hr>

                    <!-- content start -->
                    <div class="am-form-group">
                        <label for="content">网店链接 <small>(md5)</small>:</label>
                        <input type="text" id="taoBaoLink" name="taoBaoLink" value="<%= article.get('taoBaoLink') %>">
                    </div>
                    <!-- content end -->

                    <hr>

                    <!-- video start -->
                    <div class="am-form-group">
                        <label for="video-link">文章视频：</label>
                        <input id="video-link" name="video-link" type="text" value="<%= article.get('videoLink')%>" placeholder="输入文章视频"/>
                        <br>
                        <div class="upload-content">
                            <iframe class="upload" src="/admin/article/upload?callback=uploadVideoFileSuccess" frameborder="0"></iframe>
                        </div>
                    </div>
                    <!-- video end -->

                    <hr>

                    <div class="am-form-group">
                        <button id="submit" type="submit" class="am-btn am-btn-primary">保存</button>
                        <button type="button" class="am-btn am-btn-primary" onclick="history.back(-1);">返回</button>
                    </div>

                </form>

            </div>
        </div>

    </div>
    <!-- content end -->

</div>


<% include ../partials/footer %>
<% include ../partials/js %>

<script type="text/javascript">
    var article;
    $(function () {
        require('upload');
        article = require('article');
        article.editFun();
    });


    //iframe upload detail images callback
    function uploadDetailImageSuccess(data) {
        article.uploadDetailImageSuccess(data);
    }

    //iframe upload callback
    function uploadMainImageSuccess(data) {
        $('#image').val(data[0].url);

    }
    //iframe upload callback
    function uploadVideoFileSuccess(data) {
        $('#video-link').val(data[0].url);
    }
</script>

</body>
</html>