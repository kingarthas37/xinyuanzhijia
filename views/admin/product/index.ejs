<!DOCTYPE html>
<html>
<head>
    <% include ../partials/meta %>
    <title><%= title %></title>
    <% include ../partials/css %>
</head>
<body>

<% include ../partials/header %>

<% if (flash.success != '') { %>
<div class="am-alert am-alert-success">
    <p><%= flash.success %></p>
</div>
<% } %>

<div class="am-cf admin-main">

    <!-- sidebar start -->
    <% include ../partials/sidebar %>
    <!-- sidebar end -->
    
    <!-- content start -->
    <div class="admin-content">

        <div class="am-cf am-padding">
            <div class="am-fl am-cf"><strong class="am-text-primary am-text-lg"><a href="/admin/product">所有产品列表</a></strong></div>
        </div>

        <div class="am-g">
            <form class="am-form" action="/product">
                <div class="am-u-sm-12 am-u-md-3">
                    <div class="am-form-group">
                        <div class="am-input-group am-input-group-sm">
                            <input type="text" name="product-search" class="am-form-field" placeholder="搜索产品">
                            <span class="am-input-group-btn"><button class="am-btn am-btn-default" type="submit">搜索</button></span>
                        </div>
                 </div>
                </div>
                <div class="am-u-sm-12 am-u-md-3">
                    <div class="am-form-group">
                        <select class="select-category" data-am-selected="{btnSize:'sm'}">
                            <option value="0">请选择商品分类</option>
                            <% for (var i=0;i < category.length; i++) { %><option value="<%= category[i].get('categoryId'); %>"> <%= category[i].get('categoryName');%></option><% } %>
                        </select>
                    </div>
                </div>
                <div class="am-u-sm-12 am-u-md-6"></div>
            </form>
        </div>
        

        <div class="am-g">
            <div class="am-u-sm-12">
                <table class="am-table am-table-striped am-table-hover table-mai">
                    <thead>
                    <tr>
                        <th>产品名称</th>
                        <th>产品分类</th>
                        <th width="80" class="t-c small-screen-hide">创建时间</th>
                        <th width="80" class="t-c small-screen-hide">更新时间</th>
                        <th width="60" class="t-c small-screen-hide">删除</th>
                    </tr>
                    </thead>
                    <tbody>
                    <% for(var i=0; i < product.length; i++) {%>
                    <tr>
                        <td><a href="/admin/product/edit/<%= product[i].get('productId') %>"><%= product[i].get('name') %></a></td>
                        <td><a href="/admin/product?categoryId=<%= product[i].get('categoryId') %>"><%=
                            product[i].get('categoryName') %></a></td>
                        <td class="t-c small-screen-hide">
                            <%=(product[i].createdAt.getMonth()+1)%>-<%=product[i].createdAt.getDate()%>
                        </td>
                        <td class="t-c small-screen-hide">
                            <%=(product[i].updatedAt.getMonth()+1)%>-<%=product[i].updatedAt.getDate()%>
                        </td>
                        <td class="t-c small-screen-hide"><a href="/product/remove/<%= product[i].get('productId') %>" class="remove-product">删除</a></td>
                    </tr>
                    <% } %>
                    </tbody>
                </table>

                <div class="am-cf">
                    <div class="am-fl">
                        <ul class="am-pagination">
                            <% if (productPager.prev) { %>
                            <li>
                                <a href="/admin/product?page=<%= productPager.prev %><% if (categoryId) {%>&categoryId=<%=categoryId%> <%}%><% if (search) {%>&product-search=<%=search%> <%}%>">上一页</a>
                            </li>
                            <% } %>
                            <% if (productPager.next) { %>
                            <li>
                                <a href="/admin/product?page=<%= productPager.next %><% if (categoryId) {%>&categoryId=<%=categoryId%> <%}%><% if (search) {%>&product-search=<%=search%> <%}%>">下一页</a>
                            </li>
                            <% } %>
                        </ul>
                    </div>
                    <div class="am-fr">
                        第<%=productPager.page%>页 共<%=productCount%>条
                    </div>
                </div>

                <div class="am-form-group">
                    <a href="/admin/product/add" class="am-btn am-btn-primary" role="button">添加新产品</a>
                </div>
                
            </div>
        </div>

    </div>
    <!-- content end -->

</div>

<div class="am-modal am-modal-confirm" tabindex="-1" id="confirm-remove-product">
    <div class="am-modal-dialog">
        <div class="am-modal-bd">
            确定要删除这条记录吗？
        </div>
        <div class="am-modal-footer">
            <span class="am-modal-btn" data-am-modal-confirm>确定</span>
            <span class="am-modal-btn" data-am-modal-cancel>取消</span>
        </div>
    </div>
</div>

<% include ../partials/footer %>
<% include ../partials/js %>

<script type="text/javascript">
    $(function () {
        var product = require('product');
        product.indexFun();
    });
</script>
</body>
</html>