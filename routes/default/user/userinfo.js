'use strict';

let user = require('../../../lib/models/common-member').createNew();
let config = user.getConfig();
let router = user.getRouter();
let AV = user.getAV();

let async = require('async');
let extend = require('xtend');

require('../../../lib/utils');

let data = extend(config.data, {
    title:`${config.data.name}用户信息`,
    headerTitle:'用户信息',
    currentPage: 'userinfo'
});


router.get('/', (req,res) => {
    let sessionData = req.cookies.login;
    user.isWebUserLogin(req,res);
    let member = user.getDecodeByBase64(sessionData);
    user.getMemberByMemberId(parseInt(member.id)).then(result => {
        result.attributes.birthday = result.attributes.birthday ? result.attributes.birthday.format('yyyy/M/d') : null;
        data = extend(data,{
            user:result.attributes
        });
        res.render('default/user/userinfo',data);
    });


});

//保存userinfo
router.post('/edit', (req, res) => {
    user.isWebUserLogin(req,res,data);  //判断是否登录
    user.updateUserInfo(req,res);
});

router.get('/typeahead',(req,res)=> {
    
    res.send([{"value":"神圣几何能量吊坠 - 盖亚的网络 [gaia's grid] (不锈钢) {id:258}","productId":258,"image":"http://ac-QuiPuWpJ.clouddn.com/a4485bd76d94a6dcf8ad.jpg"},{"value":"神圣几何能量吊坠 - 意识种子 [consciouseed] (不锈钢) {id:264}","productId":264,"image":"http://ac-QuiPuWpJ.clouddn.com/a509765d775dd886ce6a.jpg"},{"value":"神圣几何能量吊坠 - 意识种子 [consciouseed] (18k镀金) {id:280}","productId":280,"image":"http://ac-QuiPuWpJ.clouddn.com/1b092b99992e71c21780.jpg"},{"value":"神圣几何能量吊坠 - 盖亚网络 [gaia's grid] (18k镀金) {id:283}","productId":283,"image":"http://ac-QuiPuWpJ.clouddn.com/29d3af1cf1896f0ab4bf.jpg"},{"value":"神圣几何能量吊坠 - 64四面体 [tetrahedron 64] (18k镀金) {id:291}","productId":291,"image":"http://ac-QuiPuWpJ.clouddn.com/4609917864d4731d8033.jpg"},{"value":"祭坛布/仪式布 - 七脉轮曼陀罗 [7 chakras mandala] {id:215}","productId":215,"image":"http://ac-QuiPuWpJ.clouddn.com/255eb29cc4db71fdb7f7.jpg"},{"value":"祭坛布/仪式布 - 三摩地 [samadhi] {id:214}","productId":214,"image":"http://ac-QuiPuWpJ.clouddn.com/148ff6ff46035b63095a.jpg"},{"value":"祭坛布/仪式布 - 曼陀罗/创世纪 [genesis mandalas] {id:213}","productId":213,"image":"http://ac-QuiPuWpJ.clouddn.com/d1c5c7f90a9de892dc48.jpg"},{"value":"祭坛布/仪式布 - 曼陀罗/光 [mandalas light activation] {id:211}","productId":211,"image":"http://ac-QuiPuWpJ.clouddn.com/19fb5a7299457bfe9065.jpg"},{"value":"魔法香/净化香 - 吸引金钱和财富 [incense money drawing] {id:328}","productId":328,"image":"http://ac-QuiPuWpJ.clouddn.com/ac71ffded4d4b17c65d5.jpg"},{"value":"祭坛布/仪式布 - 紫罗兰火焰 [violette mandalas] {id:403}","productId":403,"image":"http://ac-QuiPuWpJ.clouddn.com/30e797183eeab905467f.jpg"},{"value":"Indio魔法油 - 身体保护 [oil body protection] {id:564}","productId":564,"image":"http://ac-QuiPuWpJ.clouddn.com/387827209f4972213c00.jpg"},{"value":"Goddess女神身体乳 - 伊希斯 {id:620}","productId":620,"image":"http://ac-QuiPuWpJ.clouddn.com/8b65c288ecc9e9e28c40.jpg"},{"value":"七天仪式魔法蜡烛 - 开运、清除障碍、捷径 [7 day candle road opener] {id:640}","productId":640,"image":"http://ac-QuiPuWpJ.clouddn.com/7eff8c912f3e6750515f.jpg"},{"value":"Indio魔法油 - 职场、找到好工作 [oil job] {id:313}","productId":313,"image":"http://ac-QuiPuWpJ.clouddn.com/02d317a53518f21af1d4.jpg"},{"value":"Indio魔法油 - 身心健康 [oil health healing] {id:309}","productId":309,"image":"http://ac-QuiPuWpJ.clouddn.com/f548215f944dd0443e04.jpg"},{"value":"Indio魔法油 - 移除阻碍、驱走厄运 [oil jinx removing] {id:308}","productId":308,"image":"http://ac-QuiPuWpJ.clouddn.com/0a1306b2cb814b4efcdc.jpg"},{"value":"Indio魔法油 - 开运、清除障碍、捷径、快速通向成功 [oil road opener] {id:307}","productId":307,"image":"http://ac-QuiPuWpJ.clouddn.com/d7cd984495992a9e747e.jpg"},{"value":"Indio魔法油 - 家庭和睦 [oil peaceful home] {id:306}","productId":306,"image":"http://ac-QuiPuWpJ.clouddn.com/8e53f4af77d7088f2174.jpg"},{"value":"Indio魔法油 - 驱走不喜欢的人 [oil hot foot] {id:305}","productId":305,"image":"http://ac-QuiPuWpJ.clouddn.com/8408c80a031d127a3317.jpg"},{"value":"Indio魔法油 - 改善你与上司的关系 [oil boss fix] {id:303}","productId":303,"image":"http://ac-QuiPuWpJ.clouddn.com/9043824d022bd7ea51d7.jpg"},{"value":"Indio魔法油 - 清除负能量、扫除障碍 [oil clearance] {id:302}","productId":302,"image":"http://ac-QuiPuWpJ.clouddn.com/497968f8079aa312cb86.jpg"},{"value":"Indio魔法油 - 吸引对方来到我身边 [oil come to me] {id:295}","productId":295,"image":"http://ac-QuiPuWpJ.clouddn.com/5cdf0a26d9e127780181.jpg"},{"value":"Indio魔法油 - 商务、吸引客户 [oil better business] {id:277}","productId":277,"image":"http://ac-QuiPuWpJ.clouddn.com/b140e6d457dbe19b6ac5.jpg"},{"value":"Indio魔法油 - 旧情人复合 [oil intranquil] {id:273}","productId":273,"image":"http://ac-QuiPuWpJ.clouddn.com/a37eb7d14ec8bc82a188.jpg"},{"value":"Indio魔法油 - 金钱雨、快速吸引金钱 [oil money rain] {id:271}","productId":271,"image":"http://ac-QuiPuWpJ.clouddn.com/5dfb2a5b2ef536ed74c1.jpg"},{"value":"Indio魔法油 - 快速带来金钱 [oil bring money fast] {id:270}","productId":270,"image":"http://ac-QuiPuWpJ.clouddn.com/4e36802d76dad0ef4164.jpg"},{"value":"Indio魔法油 - 吸引金钱和财富 [oil money drawing] {id:269}","productId":269,"image":"http://ac-QuiPuWpJ.clouddn.com/0268b7ad3aff461a4b67.jpg"},{"value":"Indio魔法油 - 美丽、爱情、富有 [oil ochun] {id:268}","productId":268,"image":"http://ac-QuiPuWpJ.clouddn.com/c1f007bd36911a6fc4b5.jpg"},{"value":"Indio魔法油 - 偏财运、好运 [oil fast luck] {id:276}","productId":276,"image":"http://ac-QuiPuWpJ.clouddn.com/6a602af303ae34955709.jpg"},{"value":"Indio魔法油 - 全方位提升 [oil all purpose] {id:314}","productId":314,"image":"http://ac-QuiPuWpJ.clouddn.com/a5b860ccc46aeea5d3b6.jpg"},{"value":"Indio魔法油 - 命令、控制 [oil commanding] {id:318}","productId":318,"image":"http://ac-QuiPuWpJ.clouddn.com/4329928f970537c9e8bb.jpg"},{"value":"Anna魔法油 - 敏锐/理解力/反应力 [oil knowledge] {id:322}","productId":322,"image":"http://ac-QuiPuWpJ.clouddn.com/58ddb99e0e56e005a417.jpg"},{"value":"Anna魔法油 - 智慧/判断力 [oil wisdom] {id:323}","productId":323,"image":"http://ac-QuiPuWpJ.clouddn.com/23fc9c05720c741477f8.jpg"},{"value":"Anna魔法油 - 记忆力/集中力/专注力 [oil orchid] {id:324}","productId":324,"image":"http://ac-QuiPuWpJ.clouddn.com/e92b367a0492f1b974bf.jpg"},{"value":"七天仪式魔法蜡烛 - 吸引金钱、财富 [7 day candle money drawing] {id:408}","productId":408,"image":"http://ac-QuiPuWpJ.clouddn.com/945fbdfcb319ff025021.jpg"},{"value":"七天仪式魔法蜡烛 - 吸引爱情 [7 day candle love drawing] {id:409}","productId":409,"image":"http://ac-QuiPuWpJ.clouddn.com/03acd5eb2dfce522cd42.jpg"},{"value":"七天仪式魔法蜡烛 - 七运 [7 day candle seven african powers] {id:410}","productId":410,"image":"http://ac-QuiPuWpJ.clouddn.com/11f1c18716f1f6ccd9f7.jpg"},{"value":"七天仪式魔法蜡烛 - 转运 [7 day candle reversible] {id:411}","productId":411,"image":"http://ac-QuiPuWpJ.clouddn.com/ce42c82f16f0b2338a39.jpg"},{"value":"Indio魔法油 - 婚姻 [oil marriage] {id:413}","productId":413,"image":"http://ac-QuiPuWpJ.clouddn.com/b17f5dc5383ef0176701.jpg"},{"value":"Indio魔法油 - 还我钱 [oil give me your money] {id:438}","productId":438,"image":"http://ac-QuiPuWpJ.clouddn.com/bf6cfeeab93558e79036.jpg"},{"value":"天使/大天使花精 - 智慧天使 [essence wisdom] {id:461}","productId":461,"image":"http://ac-QuiPuWpJ.clouddn.com/4fe29a6551b478618e37.jpg"},{"value":"天使/大天使花精 - 丰盛天使 [essence abundance] {id:462}","productId":462,"image":"http://ac-QuiPuWpJ.clouddn.com/3a06ce953bbb17ea8689.jpg"},{"value":"内在小孩花精 - 守护天使 [essence guardian angel] {id:482}","productId":482,"image":"http://ac-QuiPuWpJ.clouddn.com/1cf03e5605cf2330ab0f.jpg"},{"value":"彩虹光体花精 - 因果体 [essence causal body] {id:489}","productId":489,"image":"http://ac-QuiPuWpJ.clouddn.com/779bf1538491deb280f4.jpg"},{"value":"彩虹光体花精 - 乙太体 [essence etheric body] {id:490}","productId":490,"image":"http://ac-QuiPuWpJ.clouddn.com/3cfd87a704898e3039df.jpg"},{"value":"彩虹光体花精 - 情绪体 [essence emotional body] {id:494}","productId":494,"image":"http://ac-QuiPuWpJ.clouddn.com/85ec53d00838ef1f3b94.jpg"},{"value":"彩虹光体花精 - 理智体 [essence mental body] {id:495}","productId":495,"image":"http://ac-QuiPuWpJ.clouddn.com/742963d27031b684a395.jpg"},{"value":"Anna魔法油 - 阻止不忠 [oil black devil] {id:440}","productId":440,"image":"http://ac-QuiPuWpJ.clouddn.com/d071b4cdf76e97016c80.jpg"},{"value":"七脉轮按摩膏 - 眉心轮/三眼轮 [balm third eye chakra] {id:515}","productId":515,"image":"http://ac-QuiPuWpJ.clouddn.com/229a191174d3eb8f7195.jpg"},{"value":"Indio魔法皂 - 吸引金钱和财富 [soap money drawing] {id:533}","productId":533,"image":"http://ac-QuiPuWpJ.clouddn.com/e58a82873f283719941e.jpg"},{"value":"Indio魔法皂 - 快速带来金钱 [soap fast money] {id:534}","productId":534,"image":"http://ac-QuiPuWpJ.clouddn.com/8ba67d0a9cb78308a88d.jpg"},{"value":"Indio魔法皂 - 偏财运/好运 [soap fast luck] {id:535}","productId":535,"image":"http://ac-QuiPuWpJ.clouddn.com/da2206d009631c6a3421.jpg"},{"value":"七天仪式魔法蜡烛 - 偏财运、好运 [7 day candle fast luck] {id:537}","productId":537,"image":"http://ac-QuiPuWpJ.clouddn.com/d4b1ed3dd8b9f6c24efb.jpg"},{"value":"Indio浴盐 - 吸引金钱和财富 [bath salt money drawing] {id:538}","productId":538,"image":"http://ac-QuiPuWpJ.clouddn.com/2d125d7ff2f8504871c8.jpg"},{"value":"Indio浴盐 - 守护天使 [bath salt angel sand] {id:539}","productId":539,"image":"http://ac-QuiPuWpJ.clouddn.com/b40497b07f26300fe36d.jpg"},{"value":"Indio浴盐 - 幸运/好运 [bath salt good luck] {id:540}","productId":540,"image":"http://ac-QuiPuWpJ.clouddn.com/4a4b7f0fc6e264109597.jpg"},{"value":"Indio浴盐 - 增加行动力 [bath salt high john the conqueror] {id:541}","productId":541,"image":"http://ac-QuiPuWpJ.clouddn.com/196e0e6a348b99b17e82.jpg"},{"value":"Indio浴盐 - 移除阻碍、驱走厄运 [bath salt jinx removing] {id:542}","productId":542,"image":"http://ac-QuiPuWpJ.clouddn.com/33c4f88eaf41584fbc29.jpg"},{"value":"魔法香/净化香 - 贵人、援助 [incense helping hand] {id:568}","productId":568,"image":"http://ac-QuiPuWpJ.clouddn.com/36b7a697edefc4865709.jpg"},{"value":"Goddess女神香水 - 拉达 {id:610}","productId":610,"image":"http://ac-QuiPuWpJ.clouddn.com/8f3651490ac44e9584fc.jpg"},{"value":"Goddess女神身体乳 - 杜尔加 {id:615}","productId":615,"image":"http://ac-QuiPuWpJ.clouddn.com/5e8c165a50af8b580602.jpg"},{"value":"Goddess女神身体乳 - 雅典娜 {id:619}","productId":619,"image":"http://ac-QuiPuWpJ.clouddn.com/e06bb419767bbc66f86c.jpg"},{"value":"Goddess女神身体乳 - 帕瓦蒂 {id:621}","productId":621,"image":"http://ac-QuiPuWpJ.clouddn.com/212efbcd49367e7ac890.jpg"},{"value":"七天仪式魔法蜡烛 - 商务、吸引客户 [7 day candle better business] {id:638}","productId":638,"image":"http://ac-QuiPuWpJ.clouddn.com/40ee0e85ad032d485489.jpg"},{"value":"七天仪式魔法蜡烛 - 解除诅咒、破除困境 [7 day candle block buster] {id:639}","productId":639,"image":"http://ac-QuiPuWpJ.clouddn.com/6f1a0c307b3158688e94.jpg"},{"value":"水晶能量盘 - 曼陀罗 [alchemy mandala] {id:508}","productId":508,"image":"http://ac-QuiPuWpJ.clouddn.com/ff8299014ab9db967302.jpg"},{"value":"水晶能量盘 - 生命之花 [flower of life tetrahedron] {id:512}","productId":512,"image":"http://ac-QuiPuWpJ.clouddn.com/7596a82997f70465ab35.jpg"},{"value":"水晶能量盘 - 内在智慧 [inner wisdom] {id:510}","productId":510,"image":"http://ac-QuiPuWpJ.clouddn.com/d9e83d37939538dd0590.jpg"},{"value":"Indio魔法油 - 贵人、援助 [oil helping hand] {id:565}","productId":565,"image":"http://ac-QuiPuWpJ.clouddn.com/a7370c2efdc5ebff6762.jpg"},{"value":"Indio魔法油 - 吸引金钱、好运、爱情 [oil drawing] {id:566}","productId":566,"image":"http://ac-QuiPuWpJ.clouddn.com/b1e801c48b2a488880b9.jpg"},{"value":"Indio魔法油 - 繁荣、成功、能量启动 [oil van van] {id:301}","productId":301,"image":"http://ac-QuiPuWpJ.clouddn.com/8d2000957c32079be0f0.jpg"},{"value":"Indio魔法油 - 黑伞保护 [oil black protection] {id:567}","productId":567,"image":"http://ac-QuiPuWpJ.clouddn.com/b1e801c48b2a488880b9.jpg"},{"value":"Indio魔法油 - 蜂鸟 [oil hummingbird] {id:578}","productId":578,"image":"http://ac-QuiPuWpJ.clouddn.com/3207970c3ceb9888cb32.jpg"},{"value":"Fleurs女神能量花精 - 德墨忒尔 [essence demeter] {id:588}","productId":588,"image":"http://ac-QuiPuWpJ.clouddn.com/8a6f016abda2c7ffddbd.jpg"},{"value":"Fleurs女神能量花精 - 罗陀女神 [essence radha] {id:594}","productId":594,"image":"http://ac-QuiPuWpJ.clouddn.com/09689e24ce0e8985add6.jpg"},{"value":"Indio魔法皂 - 七运 [soap seven african powers] {id:597}","productId":597,"image":"http://ac-QuiPuWpJ.clouddn.com/e871fda141200187a3ed.jpg"},{"value":"Indio魔法皂 - 清除负能量 [soap clearance] {id:598}","productId":598,"image":"http://ac-QuiPuWpJ.clouddn.com/a00a82767ebbba3e1d81.jpg"},{"value":"Goddess女神香水 - 拉特莉 {id:607}","productId":607,"image":"http://ac-QuiPuWpJ.clouddn.com/3ecfd61b72e11d9593a1.jpg"},{"value":"Goddess女神香水 - 杜尔加 {id:608}","productId":608,"image":"http://ac-QuiPuWpJ.clouddn.com/d47173868206a25c0f4d.jpg"},{"value":"Goddess女神香水 - 帕瓦蒂 {id:609}","productId":609,"image":"http://ac-QuiPuWpJ.clouddn.com/b123f42d6a117c7b3c08.jpg"},{"value":"Goddess女神香水 - 伊希斯 {id:611}","productId":611,"image":"http://ac-QuiPuWpJ.clouddn.com/3acc309c9b353c252099.jpg"},{"value":"Goddess女神香水 - 萨拉斯沃蒂 {id:612}","productId":612,"image":"http://ac-QuiPuWpJ.clouddn.com/08957ffe7580a036bb87.jpg"},{"value":"Goddess女神香水 - 拉克希米 {id:613}","productId":613,"image":"http://ac-QuiPuWpJ.clouddn.com/420f7e1fbd7e02d6f016.jpg"},{"value":"Goddess女神身体乳 - 拉特莉 {id:616}","productId":616,"image":"http://ac-QuiPuWpJ.clouddn.com/02f14ff413a731c12c56.jpg"},{"value":"Goddess女神身体乳 - 萨拉斯沃蒂 {id:617}","productId":617,"image":"http://ac-QuiPuWpJ.clouddn.com/133910527486ba11b95c.jpg"},{"value":"Goddess女神身体乳 - 拉克希米 {id:618}","productId":618,"image":"http://ac-QuiPuWpJ.clouddn.com/635cf0f6e909da28ed4c.jpg"},{"value":"Indio魔法油 - 增加家庭财富 [oil money house blessing] {id:319}","productId":319,"image":"http://ac-QuiPuWpJ.clouddn.com/65db1b82dba2e54a0395.jpg"},{"value":"Indio魔法油 - 成功 [oil success] {id:312}","productId":312,"image":"http://ac-QuiPuWpJ.clouddn.com/9145f8ebd17c83b26a2d.jpg"},{"value":"Indio魔法油 - 转运 [oil reversible] {id:311}","productId":311,"image":"http://ac-QuiPuWpJ.clouddn.com/192d09c9b3b8bb750e2a.jpg"},{"value":"Indio魔法油 - 精力充沛、健康 [oil radiant health] {id:310}","productId":310,"image":"http://ac-QuiPuWpJ.clouddn.com/0ca3d02b7925b1a4fd17.jpg"},{"value":"Indio魔法油 - 快速进展 [oil progress] {id:315}","productId":315,"image":"http://ac-QuiPuWpJ.clouddn.com/88951720f723dd84c55f.jpg"},{"value":"Indio魔法油 - 远离麻烦事 [oil keep away troubles] {id:304}","productId":304,"image":"http://ac-QuiPuWpJ.clouddn.com/1d121d5816d2d990663a.jpg"},{"value":"Indio魔法油 - 吸引另一半 [oil attraction] {id:275}","productId":275,"image":"http://ac-QuiPuWpJ.clouddn.com/a9b455df0e82df7cf345.jpg"},{"value":"Indio魔法油 - 七运 [oil seven african powers] {id:274}","productId":274,"image":"http://ac-QuiPuWpJ.clouddn.com/f9ec20097ea03190ceb6.jpg"},{"value":"Indio魔法油 - 爱我 [oil love me] {id:272}","productId":272,"image":"http://ac-QuiPuWpJ.clouddn.com/7fbed9eac1b09593ac73.jpg"},{"value":"Indio魔法皂 - 全方位 [soap all purpose] {id:536}","productId":536,"image":"http://ac-QuiPuWpJ.clouddn.com/1ebdfbf13002722c241d.jpg"},{"value":"七天仪式魔法蜡烛 - 蜂鸟 [7 day candle hummingbird] {id:645}","productId":645,"image":"http://ac-QuiPuWpJ.clouddn.com/84d70cef0d3ea8333b8e.jpg"},{"value":"七天仪式魔法蜡烛 - 职场、工作 [7 day candle job] {id:647}","productId":647,"image":"http://ac-QuiPuWpJ.clouddn.com/e6fc3db541528e36f12c.jpg"},{"value":"Indio魔法油 - 照我说的做 [oil do as i say] {id:648}","productId":648,"image":"http://ac-QuiPuWpJ.clouddn.com/d0d0d490ef527bb62e0b.jpg"}]);
    
});

module.exports = router;