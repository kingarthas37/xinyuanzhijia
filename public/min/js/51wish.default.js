require=function n(e,t,o){function i(a,l){if(!t[a]){if(!e[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=t[a]={exports:{}};e[a][0].call(u.exports,function(n){var t=e[a][1][n];return i(t?t:n)},u,u.exports,n,e,t,o)}return t[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({5:[function(n,e,t){"use strict";n("../../../../js/main"),n("./config"),n("./common"),n("./common-dom"),n("./utils"),n("./log")},{"../../../../js/main":17,"./common":2,"./common-dom":1,"./config":3,"./log":4,"./utils":6}],3:[function(n,e,t){"use strict";window.leanApp={AppID:"QuiPuWpJPzCahsgBK7teBOJN-gzGzoHsz",AppKey:"Wwh9RRHIySPlvToe3dsIVfS7",MasterKey:"mCIsLsrtOgujruzfcEGDm9Uh",api:"https://api.leancloud.cn/1.1/"},window.taobaoShop={shop1Name:"暮雪的心愿城",shop2Name:"亚特兰蒂斯之谜",shop1:"//muxue698.taobao.com",shop2:"//muxue928.taobao.com"}},{}],2:[function(n,e,t){"use strict";n("amazeui");Array.prototype.unique=function(){for(var n=[],e={},t=0;t<this.length;t++)e[this[t]]||(n.push(this[t]),e[this[t]]=1);return n},Array.prototype.remove=function(n){for(var e=0;e<this.length;e++){var t=this[e];if(isNaN(n)||(t=e),t==n){for(var o=e;o<this.length;o++)this[o]=this[o+1];this.length=this.length-1}}},$(function(){window.WIN_WIDTH=$(window).width(),window.WIN_HEIGHT=$(window).height(),window.leanAppHeader={"x-avoscloud-application-id":window.leanApp.AppID,"x-avoscloud-application-key":window.leanApp.AppKey,"content-type":"application/json"},window.isLogin=!!$.cookie("login"),window.globalVar={gLog:n("./log")};for(var e,t=function(){},o=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],i=o.length,r=window.console=window.console||{};i--;)e=o[i],r[e]||(r[e]=t);jQuery.validator.addMethod("isMobile",function(n,e){var t=n.length,o=/^1[0-9]{10}$/;return this.optional(e)||11==t&&o.test(n)},"请正确填写您的手机号码")})},{"./log":4,amazeui:8}],4:[function(n,e,t){"use strict";e.exports={_l:function(n){if(n){for(var e=n[0],t=1;t<n.length;t++)e=e.indexOf("%s")>-1?e.replace("%s",n[t]):e.replace("{}",n[t]);console.log(e)}},_serializeArguments:function(n){if(n){for(var e=n[0],t=1;t<n.length;t++)e=e.indexOf("%s")>-1?e.replace("%s",n[t]):e.replace("{}",n[t]);return e}},serializeArguments:function(n){return this._serializeArguments(Array.prototype.slice.apply(arguments))},log:function(n){this._l(Array.prototype.slice.apply(arguments))},info:function(n){this._l(Array.prototype.slice.apply(arguments))},debug:function(n){this._l(Array.prototype.slice.apply(arguments))},warn:function(n){var e=Array.prototype.slice.apply(arguments);e&&(e[0]="[warn]"+e[0]),this._l(e)},error:function(n){var e=Array.prototype.slice.apply(arguments);e&&(e[0]="[error]"+e[0]),this._l(e)},writeObjToJson:function(n){return JSON.stringify(n)}}},{}],1:[function(n,e,t){"use strict";n("bloodhound");$(function(){$(".go-back").click(function(){history.go(-1)}),$("img.lazy").lazyload();var n=$(".am-alert");n.length&&(n.fadeIn(),setTimeout(function(){return n.fadeOut()},2e3)),$.fn.setInfinitescroll=function(n){var e=$(this),t=$.extend({navSelector:".navigation",nextSelector:".navigation a",setPathParse:function(){},setData:function(){}},n||{});return e.infinitescroll({debug:!1,loading:{img:"//lc-joabcrtt.cn-n1.lcfile.com/8ded071cdd14788c50fa.gif",msgText:"加载中...",speed:500},animate:!1,itemSelector:"li",navSelector:t.navSelector,nextSelector:t.nextSelector,dataType:"json",appendCallback:!1,pathParse:function(n,e){return t.setPathParse(n,e)}},function(n,o){if(!n.items.length){$("#infscr-loading").detach(),e.infinitescroll("unbind"),e.append('<div class="loading"></div>');var i=$('<div id="infscr-loading" style="display:none;">已加载全部内容</div>');return e.find(".loading").append(i),i.fadeIn(),setTimeout(function(){i.fadeOut()},3e3),!1}var r=$(t.setData(n));r.find("img.lazy").lazyload(),e.append(r)}),e}})},{bloodhound:9}]},{},[5]);
require=function t(e,i,a){function n(o,r){if(!i[o]){if(!e[o]){var c="function"==typeof require&&require;if(!r&&c)return c(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var d=i[o]={exports:{}};e[o][0].call(d.exports,function(t){var i=e[o][1][t];return n(i?i:t)},d,d.exports,t,e,i,a)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<a.length;o++)n(a[o]);return n}({7:[function(t,e,i){"use strict";t("../../../../js/main"),t("./home"),t("./order"),t("./index"),t("./user"),t("./product-list"),t("./product-detail"),t("./cart"),t("./article")},{"../../../../js/main":17,"./article":"article","./cart":"cart","./home":"home","./index":"index","./order":"order","./product-detail":"product-detail","./product-list":"product-list","./user":"user"}],user:[function(t,e,i){"use strict";e.exports={loginFun:function(){var t=$("#form"),e=$("#mobile"),i=$("#code"),a=$("#submit"),n=$("#referer");t.validate({rules:{mobile:{required:!0,minlength:11,isMobile:!0},code:{required:!0,minlength:6,maxlength:6}},messages:{mobile:{required:"请输入您的手机号码",minlength:"请输入正确的手机号码",isMobile:"请输入正确的手机号码"},code:{required:"请输入6位数验证码",minlength:"请输入6位数验证码",maxlength:"请输入6位数验证码"}},errorPlacement:function(t,e){e.parents(".am-form-group").next().html(t)},submitHandler:function(t){var s=$(t);return s.data("state")?!1:(s.data("state",!0),a.prop("disabled",!0).text("登录中..."),void $.ajax({type:"post",url:"/user/login/to-login/"+$.trim(e.val())+"/"+$.trim(i.val())}).done(function(t){t.success?(a.text("登录成功!"),setTimeout(function(){location.href=n.val()},2e3)):(a.prop("disabled",!1).text("登录"),s.data("state",!1),i.parents(".am-form-group").next().html("验证码有误或已过期,请重新输入!"))}))}}),this.getSmsCode(e),e.on({keyup:function(){$.trim(this.value)?a.prop("disabled",!1):a.prop("disabled",!0)}})},userInfoFun:function(){var t=$("#form"),e=$("#submit"),i=$("#modal-confirm");t.validate({rules:{nickname:{required:!0},birthday:{dateISO:!0}},messages:{nickname:{required:"请输入您的用户名/昵称"},birthday:{dateISO:"请输入有效的日期 (1990/12/31)"}},errorPlacement:function(t){$(".message").html(t)},submitHandler:function(){e.prop("disabled",!0),$.ajax({type:"post",url:"/user/userinfo/edit",data:t.serialize()}).then(function(t){e.prop("disabled",!1),t.success&&(i.modal({closeViaDimmer:0}),setTimeout(function(){location.href="/"},3e3))},function(t){e.prop("disabled",!1),alert(t)})}})},mobileFun:function(){var t=$("#form"),e=$("#mobile"),i=$("#code"),a=$("#submit"),n=$("#modal-confirm"),s=$("#member-id");this.getSmsCode(e),t.validate({rules:{mobile:{required:!0,minlength:11,isMobile:!0},code:{required:!0,minlength:6,maxlength:6}},messages:{mobile:{required:"请输入您的手机号码",minlength:"请输入正确的手机号码",isMobile:"请输入正确的手机号码"},code:{required:"请输入6位数验证码",minlength:"请输入6位数验证码",maxlength:"请输入6位数验证码"}},errorPlacement:function(t,e){e.parents(".am-form-group").next().html(t)},submitHandler:function(t){var o=$(t);return o.data("state")?!1:(o.data("state",!0),a.prop("disabled",!0).text("更新中..."),void $.ajax({type:"post",url:"/user/mobile/update/"+$.trim(e.val())+"/"+$.trim(i.val())+"/"+s.val()}).done(function(t){t.success?(n.modal({closeViaDimmer:0}),setTimeout(function(){location.href="/"},3e3)):(a.prop("disabled",!1).text("更新/绑定手机号"),o.data("state",!1),i.parents(".am-form-group").next().html("验证码有误或已过期,请重新输入!"))}))}}),e.on({keyup:function(){$.trim(this.value)?a.prop("disabled",!1):a.prop("disabled",!0)}})},getSmsCode:function a(t){var a=$(".get-smscode"),e=a.find("a"),i=a.find("em"),n=i.find("b");e.click(function(){var e=$.trim(t.val());return e?/^1[0-9]{10}$/.test(e)?void(t.hasClass("valid")&&$.ajax({type:"get",url:"/user/login/get-smscode/"+e}).done(function(t){if(t.success){var e=59;n.text(e),a.addClass("on");var i=setInterval(function(){e--,n.text(e),0===e&&(clearInterval(i),a.removeClass("on"))},1e3)}else a.parents(".am-form-group").next().html("请求超时,请稍后再试!")})):($(".error-mobile").text("请输入正确的手机号码"),t[0].focus(),!1):(t[0].focus(),!1)})},wishFun:function(){$(".main-list").setInfinitescroll({setPathParse:function(t,e){var i=$(".navigation").find("a").attr("href");return i=i.replace(/(page=\d+)/,"page="),[i,""]},setData:function(t){var e="";return $.each(t.items,function(t,i){var a=i.price>0?i.price+".00":"-",n=function(){var t="";for(var e in i.mainImage)if(i.mainImage[e].isMainImage){t=i.mainImage[e].url;break}return t}(),s=i.stock>0?'<span class="active"><i class="am-icon-check"></i>现货</span>':"",o=i.isRefund?'<span class="active"><i class="am-icon-history"></i>7天退款</span>':"",r=i.isHandmade?'<span class="active"><i class="am-icon-modx"></i>纯手工</span>':"",c=i.isOnly?'<span class="active"><i class="am-icon-gavel"></i>只此一件 </span>':"",l=i.stock>0?"[现货]":"",d=i.isShortStock?"[缺货]":"",u=i.isShortStock?'class="out-stock"':"";e+='\n                    <li>\n                        <div class="img">\n                            <a href="/product/detail/'+i.productId+'"><img src="//lc-joabcrtt.cn-n1.lcfile.com/3a994354f637e827ae7e.png" class="lazy" width="100" height="100" data-original="'+n+'?imageMogr2/thumbnail/200"></a>\n                        </div>\n                        <div class="detail">\n                            <h3>\n                                <a href="/product/detail/'+i.productId+'" '+u+">\n                                  "+l+d+" "+i.name+'\n                                </a>\n                            </h3>\n                            <p>\n                            <span class="price">¥ <strong>'+a+"</strong></span>\n                            <span>"+i.pageViews+"次浏览</span>\n                            <span>已售"+i.sales+"件</span>\n                            </p>\n                            <p>\n                                "+o+" "+s+" "+r+" "+c+"\n                            </p>\n                        </div>\n                    </li>\n                "}),e}}),$(".main-list").on("click",".cancel-fav",function(){var t=this;return $.ajax({url:$(this).attr("href"),success:function(){$(t).parents("li").animate({opacity:0,height:0,padding:0})}}),!1})},footmarkFun:function(){}}},{}],"product-list":[function(t,e,i){"use strict";t("../common/utils");e.exports={init:function(){var t=$(".main-list");t.setInfinitescroll({setPathParse:function(t,e){var i=$(".navigation").find("a").attr("href");return i=i.replace(/(page=\d+)/,"page="),[i,$("#ajax-search").val()]},setData:function(t){var e="";return $.each(t.items,function(t,i){var a=i.price>0?i.price+".00":"-",n=function(){var t="";for(var e in i.mainImage)if(i.mainImage[e].isMainImage){t=i.mainImage[e].url;break}return t}(),s=i.stock>0?'<span class="active"><i class="am-icon-check"></i>现货</span>':"",o=i.isRefund?'<span class="active"><i class="am-icon-history"></i>7天退款</span>':"",r=i.isHandmade?'<span class="active"><i class="am-icon-modx"></i>纯手工</span>':"",c=i.isOnly?'<span class="active"><i class="am-icon-gavel"></i>只此一件 </span>':"",l=i.stock>0?"[现货]":"",d=i.isShortStock?"[缺货]":"",u=i.isShortStock?'class="out-stock"':"",h=i.isWish?"add":"",m=i.isWish?"已收藏":"收藏";e+='\n                    <li data-product-id="'+i.productId+'">\n                        <div class="img">\n                            <a href="/product/detail/'+i.productId+'"><img src="//lc-joabcrtt.cn-n1.lcfile.com/3a994354f637e827ae7e.png" class="lazy" width="100" height="100" data-original="'+n+'?imageMogr2/thumbnail/200"></a>\n                        </div>\n                        <div class="detail">\n                            <h3>\n                                <a href="/product/detail/'+i.productId+'" '+u+">\n                                  "+l+d+" "+i.name+'\n                                </a>\n                            </h3>\n                            <p>\n                            <span class="price">¥ <strong>'+a+"</strong></span>\n                            <span>"+i.pageViews+'次浏览</span>\n                            <a class="fav '+h+'" href="javascript:;">'+m+"</a>\n                            </p>\n                            <p>\n                                "+o+" "+s+" "+r+" "+c+"\n                            </p>\n                        </div>\n                    </li>\n                "}),e}}),t.on("click",".fav",function(){var t=this;if(!window.isLogin)return location.href="/user/login?return="+location.pathname,!1;var e=$(this).parents("li").data("product-id");$(this).hasClass("add")?$.ajax({url:"/user/wish/edit/"+e}).then(function(e){e.success&&$(t).removeClass("add").text("收藏")}):$.ajax({url:"/user/wish/add/"+e}).then(function(e){e.success&&$(t).addClass("add").text("已收藏")})})}}},{"../common/utils":6}],"product-detail":[function(t,e,i){"use strict";var a=t("photoswipe"),n=t("photoswipe-ui"),s=t("../common/utils");e.exports={init:function(){function t(){$.ajax({url:"/shopping-cart/add",type:"post",data:{pid:$("#product-id").val(),count:1}}).then(function(t){console.info("成功添加到购物车!")},function(t){console.info("添加到购物车失败!",t)})}this.productId=$("#product-id").val(),this.favoriteProduct(),this.eventsGood(),this.eventsShare(),$(".am-slider").flexslider({directionNav:!1,slideshow:!1}),$("img.lazy-container").lazyload({container:$(".lazy-container-view")});var e=this,i=$(".detail-image"),a=i.find("img").length,n=0;i.find("img").each(function(t,s){s.onload=function(){n++;var t=$(s).width()/WIN_WIDTH;$(s).attr({"swipe-width":WIN_WIDTH,"swipe-height":$(s).height()/t}),n===a&&i.find("img").each(function(t,a){$(a).click(function(){e.createPhotoSwipe(i,t)})})}}),$("#tab-product-param").find("em").each(function(){if("date"==$(this).text()){var t=(new Date).getMonth()+1<=2?1:0;$(this).text((new Date).getFullYear()-t+"年")}});var s=$(".attachment-content");s.length&&s.find(".show").click(function(){s.hasClass("on")?(s.removeClass("on"),s.find(".am-icon-angle-up").removeClass("am-icon-angle-up").addClass("am-icon-angle-down")):(s.addClass("on"),s.find(".am-icon-angle-down").removeClass("am-icon-angle-down").addClass("am-icon-angle-up"))});var o=$("#buy"),r=$("#modal-buy"),c=$("#shop-link"),l=$(".open-tb-link"),d=$(".tb-name"),u=parseInt($("#product-method-id").val());if(c.val()){var h=new Clipboard(o[0],{text:function(){return c.val()}});h.on("success",function(e){r.find(".success").addClass("on"),r.find(".failed").removeClass("on"),r.modal(),t()})}else o.click(function(){r.find(".success").removeClass("on"),r.find(".failed").addClass("on"),r.modal(),t()});var m="";/http[^\s]+/.test(c.val())?(m=/(http[^\s]+)/.exec(c.val())[1],l.attr("href",m)):(l.attr("href",3===u?window.taobaoShop.shop1:window.taobaoShop.shop2),d.text(3===u?window.taobaoShop.shop1Name:window.taobaoShop.shop2Name))},favoriteProduct:function(){var t=$("#favorite"),e=$(".favorite-text"),i=$(".favorite-count");t.click(function(){if(!window.isLogin)return location.href="/user/login?return="+location.pathname,!1;var t=$(this).data("product-id"),a=parseInt(i.text());this.checked?$.ajax({url:"/user/wish/add/"+t}).then(function(t){t.success&&(e.parent().addClass("active"),e.text("已收藏"),i.text(a+1))}):$.ajax({url:"/user/wish/edit/"+t}).then(function(t){t.success&&(e.parent().removeClass("active"),e.text("收藏"),i.text(a-1))})})},createPhotoSwipe:function(t,e){var i=[];t.find("img").each(function(t,e){i.push({src:$(e).attr("data-original"),w:$(e).attr("swipe-width"),h:$(e).attr("swipe-height")})});var s={index:e},o=new a($(".pswp")[0],n,i,s);o.init()},eventsGood:function(){var t=this,e=$(".events-good");e.click(function(){if($(this).hasClass("active"))return!1;$(this).addClass("active");var e=$(this).find("em"),i=e.text()||0;0===i?e.text("( 1 )"):e.text(parseInt(i)+1),$.ajax({url:"/product/statistics/approval/"+t.productId})})},eventsShare:function(){var t=this,e=$(".events-share");e.click(function(){$(this).addClass("active"),$("body").append('<div class="share-bg"></div>'),$(".share-bg").click(function(){$(this).detach()}),$.ajax({url:"/product/statistics/share/"+t.productId})})},recommendProducts:function(t,e){for(var i=this,a=[],n=0;n<t.length;n++)for(var o=0;o<t[n].products.length;o++)a.push(t[n].products[o]);a.length>0&&$.ajax({type:"get",url:"/product/recommend/custom/"+a.join()}).then(function(a){for(var n=0;n<t.length;n++)for(var o=0;o<e.length;o++)t[n].productGroupId===e[o].productGroupId&&(t[n].name=e[o].productGroupName);for(var r=0;r<t.length;r++){t[r].html=[];for(var c=0;c<t[r].products.length;c++)for(var l=0;l<a.items.length;l++)a.items[l].productId===parseInt(t[r].products[c])&&t[r].html.push({productId:a.items[l].productId,name:a.items[l].name,image:s.productMainImageOutput(a.items[l].mainImage),price:a.items[l].price,isHot:a.items[l].isHot})}t=t.filter(function(t){return t.html.length}),i.recommendHtml(t)})},recommendHtml:function(t){var e=$(".recommend-content"),i="";$.each(t,function(t,e){i+='<div class="recommend"><h3>'+e.name+':</h3></div><div class="am-slider am-slider-default slider-recommend"><ul class="am-slides">',$.each(e.html,function(t,e){t%3===0&&(i+="<li>");var a=e.isHot?'<span class="hot"></span>':"",n=e.price?"<em>¥"+e.price+"</em>":"";i+='\n                    <dl>\n                        <dt>\n                            <a href="/product/detail/'+e.productId+'"><img src="'+e.image+'?imageMogr2/thumbnail/250" alt="'+e.name+'"></a>\n                            '+n+"\n                        </dt>\n                        <dd>"+a+e.name+"</dd>\n                    </dl>\n                "}),i+="</ul></div>"}),e.html(i),e.find(".am-slider").flexslider({directionNav:!1,slideshow:!1})}}},{"../common/utils":6,photoswipe:19,"photoswipe-ui":18}],order:[function(t,e,i){"use strict";e.exports={expressFun:function(){var t=$("#modal-search"),e=$("#modal-result");$(".search-tracking").click(function(){var i=$(this).data("tracking"),a=$(this).data("express");t.modal(),$.ajax({type:"get",url:"/order/express/query/"+i+"/"+a}).then(function(i){var a="";if(i.list)for(var n=0;n<i.list.length;n++){var s=n===i.list.length-1?"color-timeline-item-last":"",o=0===n?"green":"blue";a+='\n                            <li class="color-timeline-item '+s+'">\n                                <div class="color-timeline-item-tail"></div>\n                                <div class="color-timeline-item-head color-timeline-item-head-'+o+'"></div>\n                                <div class="color-timeline-item-content"><strong>'+i.list[n].time+"</strong> "+i.list[n].status+"</div>\n                            </li>\n                        "}else a='\n                        <li class="color-timeline-item color-timeline-item-last">\n                            <div class="color-timeline-item-tail"></div>\n                            <div class="color-timeline-item-head color-timeline-item-head-red"></div>\n                            <div class="color-timeline-item-content">'+i.msg+"</div>\n                        </li>\n                    ";t.modal("close"),e.find("ul").html(a),e.modal()},function(i){t.modal("close"),e.find("ul").html(i),e.modal()})})}}},{}],index:[function(t,e,i){"use strict";e.exports={indexFun:function(){function t(){$.each(r,function(t,e){return s>=e.top-120&&s<=e.height-120&&t!==c?(c=t,n.find(".active").removeClass("active"),void n.find("a").eq(t).addClass("active")):void 0})}var e=$(".home"),i=document.documentElement.clientHeight||document.body.clientHeight||0;e.height(i);var a=($(".content5"),$(".menu")),n=a.find("ul"),s=0;$(window).scroll(function(){var e=$(this).scrollTop();s=e,e>=i?a.addClass("active"):a.removeClass("active"),t()});var o=$("html,body"),r=[],c=0;$("div[data-target]").each(function(){var t=$(this).offset().top,e=$(this).height();$(this).attr({"data-top":t,"data-height":e}),r.push({top:t,height:e+t})}),$("a.link").click(function(){a.find(".active").removeClass("active"),$(this).addClass("active"),o.animate({scrollTop:parseInt($("div[data-target="+$(this).attr("data-link")+"]").attr("data-top"))-80})}),$('[data-toggle="popover"]').popover({trigger:"hover",html:!0})}}},{}],home:[function(t,e,i){"use strict";e.exports={init:function(){window.onload=function(){var t=$(".content1"),e=document.documentElement.clientHeight||document.body.clientHeight||0;t.height(e);var i=$(".menu"),a=i.find("ul"),n=0,s=$("html,body"),o=[],r=0;$("div[data-target]").each(function(){var t=$(this).offset().top,e=$(this).height();$(this).attr({"data-top":t,"data-height":e}),o.push({top:t,height:e+t})}),$(window).scroll(function(){var t=$(this).scrollTop();n=t,$.each(o,function(t,e){return n>=e.top&&n<=e.height&&t!==r?(r=t,a.find(".active").removeClass("active"),void a.find("a").eq(t+1).addClass("active")):void 0})}),$(".arrow").click(function(){i.find("a").eq(2).click()}),$("a.link").click(function(){i.find(".active").removeClass("active"),$(this).addClass("active"),s.animate({scrollTop:parseInt($("div[data-target="+$(this).attr("data-link")+"]").attr("data-top"))})})}}}},{}],cart:[function(t,e,i){"use strict";t("../common/utils");e.exports={init:function(){var t=$("#modal-buy");$(".shop-add-link").each(function(e,i){var a=new Clipboard(i,{text:function(){return $(i).data("shop-link")}});a.on("success",function(e){t.find(".success").addClass("on"),t.find(".failed").removeClass("on"),t.modal()})});var e=$("#modal-clear-cart");$("#clear-cart").click(function(){e.modal({relatedTarget:this,onConfirm:function(t){location.href="/shopping-cart?empty=true"}})})}}},{"../common/utils":6}],article:[function(t,e,i){"use strict";t("bloodhound"),t("../common/utils");e.exports={initDesktop:function(){var t=$(".main-list");t.setInfinitescroll({setPathParse:function(t,e){var i=$(".navigation").find("a").attr("href");return i=i.replace(/(page=\d+)/,"page="),[i,""]},setData:function(t){var e="";return $.each(t.items,function(t,i){e+='\n                        <li>\n                            <div class="content">\n                                <div class="main-img">\n                                    <a href="/blog/'+i.articleId+'"><img width="260" height="260" src="'+i.image+'" alt="'+i.name+'"></a>\n                                </div>\n                                <div class="title">\n                                    <a href="/blog/'+i.articleId+'">'+i.name+'</a>\n                                </div>\n                                <div class="info">\n                                    <div class="left">\n                \n                                    </div>\n                                    <div class="right">\n                                        <span>人气:99</span>\n                                        <span class="split"></span>\n                                        <span>日期:2018/5/24</span>\n                                    </div>\n                                </div>\n                            </div>\n                        </li>\n                '}),e}}),$(".crumb .tags").each(function(t,e){var i=this,a=$(this).data("id");$.ajax({url:"/admin/article/article-category-count/"+a}).done(function(t){$(i).find("em").text("("+t.count+")")})})},initDetailMobile:function(){this.articleId=$(".child-detail-content").attr("data-id");var t=$(".child-detail-content"),e=t.attr("data-id"),i='\n                <div class="child-detail">\n                    <h3>阅读所有子文章</h3>\n                    <ul>\n                    </ul>\n                </div>\n            ';$.ajax({url:"/admin/article/seed/"+e}).done(function(e){e.list.article&&(t.append(i),$.each(e.list.article,function(e,i){t.find("ul").append('<li><a href="/blog/'+i.articleId+'">'+i.name+"</a></li>")}))}),this.eventsGood(),this.eventsShare(),this.favoriteProduct()},favoriteProduct:function(){var t=$("#favorite"),e=$(".favorite-text"),i=$(".favorite-count");t.click(function(){if(!window.isLogin)return location.href="/user/login?return="+location.pathname,!1;var t=$(this).data("article-id"),a=parseInt(i.text());this.checked?$.ajax({url:"/user/wish/article/add/"+t}).then(function(t){t.success&&(e.parent().addClass("active"),e.text("已收藏"),i.text(a+1))}):$.ajax({url:"/user/wish/article/edit/"+t}).then(function(t){t.success&&(e.parent().removeClass("active"),e.text("收藏"),i.text(a-1))})})},eventsGood:function(){var t=this,e=$(".events-good");e.click(function(){if($(this).hasClass("active"))return!1;$(this).addClass("active");var e=$(this).find("em"),i=e.text()||0;0===i?e.text("( 1 )"):e.text(parseInt(i)+1),$.ajax({url:"/blog/statistics/approval/"+t.articleId})})},eventsShare:function(){var t=this,e=$(".events-share");e.click(function(){$(this).addClass("active"),$("body").append('<div class="share-bg"></div>'),$(".share-bg").click(function(){$(this).detach()}),$.ajax({url:"/blog/statistics/share/"+t.articleId})})},searchFun:function(){var t=$(".search-go-panel"),e=$("#search-box"),i=$(".search-close").find("a"),a=$("#search-input");t.click(function(){e.offCanvas("open")}),i.click(function(){e.offCanvas("close")}),e.on("open.offcanvas.amui",function(){a[0].focus()});var n=$.cookie("search-article-result"),s=$("#search-input"),o=$(".search-history ul"),r=$(".search-form"),c=[];n?(c=n.split(","),$.each(c,function(t,e){e=decodeURIComponent(e),o.append('<li><a href="/blog?keywords='+e+'">'+e+"</a></li>")})):o.append('<li><a class="color-gray" href="javascript:;">无搜索记录</a></li>'),r.submit(function(){var t=$.trim(s.val());c.unshift(t),c=c.unique(),c.length>5&&(c.length=5),$.cookie("search-article-result",c.join(),{expires:new Date((new Date).getTime()+2592e6),path:"/"})}),$(".clear-history").click(function(){return o.find("li").length?(o.find("li").detach(),void $.cookie("search-article-result","",{expires:new Date((new Date).getTime()),path:"/"})):!1})}}},{"../common/utils":6,bloodhound:9}]},{},[7]);